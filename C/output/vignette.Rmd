<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{An R Markdown Vignette made with knitr}
-->

NMGS - Neutral models for community assembly
===========

### Installing and loading the development version

```{r install2, eval=FALSE}
install.packages("devtools")
library(devtools)
install_github("NMGS", "microbiome", subdir = "R/pkg/")
library(NMGS)
```

### Learning the NMGS model

Carry out the NMGS simulations with the [C
scripts](https://github.com/microbiome/NMGS/tree/master/C). These will
produce the NMGS [output
files](https://github.com/microbiome/NMGS/tree/master/C/output).


### Reading the NMGS outputs

Read the output files in R for further analysis. We assume you have
the C output files in the working directory.

```{r io, message=FALSE, warning=FALSE}
samples <- read_nmgs("Simulation_out.csv")
metacommunity <- read_nmgs_metacommunity("Simulation_out_m.csv")
stats <- read_nmgs_stats("Simulation_out_s.csv")
```

### Analyze the NMGS outputs

Calculate medians for all samples:

```{r medians, message=FALSE, warning=FALSE}
medians <- nmgs_median(samples, burnin = 25000)
print(medians)
```

Test neutrality:

```{r neutrality, message=FALSE, warning=FALSE}
# Compare the log-likelihood under the full neutral 
# model with the observed data.
print(nmgs_neutrality(stats, "LN", "LO"))

# The same but for local community assembly. 
print(nmgs_neutrality(stats, "LL", "LO"))
```

Calculate metapopulation average (currently only for the local communities):

```{r metapop, message=FALSE, warning=FALSE}
print(nmgs_metapopulation_average(metacommunity)$local)
```


### Licensing and Citations

This work can be freely used, modified and distributed under the 
[GNU General Public GPL>=2 license](https://en.wikipedia.org/wiki/GNU_General_Public_License).

Kindly cite the work, if appropriate, as 'Leo Lahti, Christoper Quince et al. (2013). NMGS R package. URL: https://github.com/microbiome/NMGS)'. 


### Session info

This vignette was created with

```{r sessioninfo, message=FALSE, warning=FALSE}
sessionInfo()
```




